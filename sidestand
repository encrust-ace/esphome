esphome:
  name: sidestand
  friendly_name: "Sidestand"

esp8266:
  board: nodemcuv2
  restore_from_flash: true

logger:
api:
ota:
  - platform: esphome

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  ap:
    ssid: "Sidestand Fallback Hotspot"
    password: "12345678"

captive_portal:
web_server:
improv_serial:
debug:
  update_interval: 60s
wled:

# ========== SENSORS ==========
sensor:
  - platform: wifi_signal
    name: "WiFi Signal (dBm)"
    id: wifi_signal_db
    update_interval: 60s
    entity_category: "diagnostic"

  - platform: copy # Reports the WiFi signal strength in %
    source_id: wifi_signal_db
    name: "WiFi Signal"
    filters:
      - lambda: return min(max(2 * (x + 100.0), 0.0), 100.0);
    unit_of_measurement: "%"
    entity_category: "diagnostic"
    device_class: ""

  - platform: uptime
    name: "Uptime"
    unit_of_measurement: "s"
    entity_category: "diagnostic"

  - platform: debug
    free:
      name: "Heap Free"

# ========== TEXT SENSORS ==========
text_sensor:
  - platform: wifi_info
    ip_address:
      name: "IP Address"
      icon: "mdi:ip-network"
      entity_category: "diagnostic"
    ssid:
      name: "Connected SSID"
      icon: "mdi:wifi"
      entity_category: "diagnostic"

# ========== LIGHT ==========
light:
  - platform: neopixelbus
    type: GRB
    variant: WS2812X
    pin: GPIO02
    num_leds: 87
    id: strip_light_1
    name: "Light 1"
    restore_mode: RESTORE_DEFAULT_OFF
    effects:
      - random:
      - pulse:
      - addressable_flicker:
      - addressable_fireworks:
      - addressable_twinkle:
      - addressable_random_twinkle:
      - addressable_scan:
      - addressable_color_wipe:
      - addressable_rainbow:
          name: "Rainbow"
      - addressable_rainbow:
          name: "Slow Rainbow"
          speed: 5
      - wled:
          name: "UDP Sync"

  - platform: neopixelbus
    type: GRB
    variant: WS2812X
    pin: GPIO03
    num_leds: 87
    id: strip_light_2
    name: "Light 2"
    restore_mode: RESTORE_DEFAULT_OFF
    effects:
      - random:
      - pulse:
      - addressable_flicker:
      - addressable_fireworks:
      - addressable_twinkle:
      - addressable_random_twinkle:
      - addressable_scan:
      - addressable_color_wipe:
      - addressable_rainbow:
          name: "Rainbow"
      - addressable_rainbow:
          name: "Slow Rainbow"
          speed: 5
      - wled:
          name: "UDP Sync"
